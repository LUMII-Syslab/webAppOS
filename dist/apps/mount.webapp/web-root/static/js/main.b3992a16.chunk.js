(this["webpackJsonpmount.webapp"]=this["webpackJsonpmount.webapp"]||[]).push([[0],{141:function(t,e,n){t.exports=n(176)},146:function(t,e,n){},147:function(t,e,n){t.exports=n.p+"static/media/logo.5d5d9eef.svg"},148:function(t,e,n){},176:function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),i=n(11),s=n.n(i),r=(n(146),n(51)),u=n(82),l=n(48),c=n(54),m=n(88),d=n(87),h=(n(147),n(148),n(1)),f=n(181),v=n(86),p=(n(149),n(150),n(151),window.webappos),g=function(t){Object(m.a)(n,t);var e=Object(d.a)(n);function n(t){var o;Object(u.a)(this,n),(o=e.call(this,t)).myRef=a.a.createRef(),o.state={mountPoints:[],supportedFS:[],columnWidths:[null,null,null,35]},o.lastW=0;var i=Object(l.a)(o);return p.request_scopes("webappos_scopes","login").then((function(){p.webcall("webappos.getSupportedFileSystems").then((function(t){t.result&&(console.log("supported_fs",t.result),i.setState({supportedFS:[].concat(Object(r.a)(t.result),["gdrive","onedrive"])},(function(){i.readRegistry()})))}))})),o}return Object(c.a)(n,[{key:"collectMountPointsRecursively",value:function(t,e,n){for(var o in t)"string"===typeof t[o]?e.push({mountPoint:n+o,driver:this.getLocationPrefix(t[o]),location:this.removeLocationPrefix(t[o])}):this.collectMountPointsRecursively(t[o],e,n+o+"/");return e}},{key:"updateColumnWidths",value:function(){if(this.myRef.current){var t=this.myRef.current.rootTableElement.offsetWidth-35-35;if(this.lastW!=t){this.lastW=t,console.log("w",t);var e=Object(r.a)(this.state.columnWidths);e[0]=.25*t,t-=e[0],e[1]=100,t-=100,e[2]=t,this.setState({columnWidths:e})}}}},{key:"readRegistry",value:function(){var t=this;p.webcall("webappos.getUserRegistryValue","fs_mount_points").then((function(e){e.result&&(console.log("registry data",e.result),t.setState({mountPoints:t.collectMountPointsRecursively(e.result,[],"")}))}))}},{key:"writeRegistry",value:function(){for(var t=0;t<this.state.mountPoints.length;t++){var e=this.state.mountPoints[t],n=e.mountPoint.trim();n&&p.webcall("webappos.setUserRegistryValue",{key:"fs_mount_points/"+n,value:e.driver+":"+e.location})}}}]),Object(c.a)(n,[{key:"componentDidMount",value:function(){this.updateColumnWidths()}},{key:"componentDidUpdate",value:function(){console.log("state2",this.state)}},{key:"handleColumnWidthChanged",value:function(t,e){console.log(t,e);var n=Object(r.a)(this.state.columnWidths);n[t]=e,this.setState({columnWidths:n})}},{key:"getLocationPrefix",value:function(t){var e=t.indexOf(":");return e>=0?t.substring(0,e):""}},{key:"removeLocationPrefix",value:function(t){var e=t.indexOf(":");return e>=0?t.substring(e+1):t}},{key:"render",value:function(){var t=this;return a.a.createElement("div",{style:{width:"100%"},onResize:this.updateColumnWidths()},a.a.createElement(f.a,{ref:this.myRef,numRows:this.state.mountPoints.length,enableRowResizing:!1,maxRowHeight:32,minRowHeight:32,defaultRowHeight:32,style:{width:"100%"},columnWidths:this.state.columnWidths,onColumnWidthChanged:this.handleColumnWidthChanged},a.a.createElement(v.a,{name:"Mount Point",cellRenderer:function(e){return a.a.createElement("input",{type:"text",value:t.state.mountPoints[e].mountPoint,onChange:function(n){t.state.mountPoints[e].mountPoint=n.target.value,t.setState({mountPoints:t.state.mountPoints})}})}}),a.a.createElement(v.a,{name:"Driver",cellRenderer:function(e){return a.a.createElement("select",{onChange:function(n){t.state.mountPoints[e].driver=n.target.value,t.setState({mountPoints:t.state.mountPoints})}}," ",t.state.supportedFS.map((function(n){return a.a.createElement("option",{value:n,selected:t.state.mountPoints[e].driver==n},n)})))}}),a.a.createElement(v.a,{name:"Location",cellRenderer:function(e){return a.a.createElement("input",{type:"text",value:t.state.mountPoints[e].location,onChange:function(n){t.state.mountPoints[e].location=n.target.value,t.setState({mountPoints:t.state.mountPoints})}})}}),a.a.createElement(v.a,{name:"",cellRenderer:function(t){return a.a.createElement(h.Button,{icon:"delete"})}})),a.a.createElement("div",{style:{float:"left"}},a.a.createElement(h.Button,{icon:"add",onClick:function(e){t.state.mountPoints.push({mountPoint:"some dir",driver:"",location:""}),t.setState({mountPoints:t.state.mountPoints})}})),a.a.createElement("div",{style:{float:"right"}},a.a.createElement(h.Button,{icon:"refresh",onClick:function(e){t.readRegistry()}},"Reset"),a.a.createElement(h.Button,{icon:"tick-circle",onClick:function(e){t.writeRegistry()}},"Save")))}}]),n}(a.a.Component);var y=function(){return a.a.createElement("div",{className:"App"},a.a.createElement(g,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[141,1,2]]]);
//# sourceMappingURL=main.b3992a16.chunk.js.map