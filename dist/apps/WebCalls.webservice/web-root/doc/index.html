<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Web Calls Service API.txt</title><link rel="stylesheet" type="text/css" href="Default.css" /><script type="text/javascript" src="../../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Web_Calls_Service_API"></a><a name="Topic42"></a><div class="CTopic TFile LTextFile first">
 <div class="CTitle">Web Calls Service API</div>
</div>

<a name="Introduction"></a><a name="Topic43"></a><div class="CTopic TGroup LTextFile">
 <div class="CTitle">Introduction</div>
 <div class="CBody"><p>The Web Calls Service is used by webAppOS and some apps to invoke web calls.</p></div>
</div>

<a name="Access_URL"></a><a name="Topic44"></a><div class="CTopic TGroup LTextFile">
 <div class="CTitle">Access URL</div>
 <div class="CBody"><p>The Web Calls Service is accessible via the following URL:</p><pre>GET/POST http[s]://[domain_or_ip]/services/webcalls/[action-name]<br />GET/POST http[s]://[domain_or_ip]/services/webcalls/[action-name]?login=[login]&amp;ws_token=[ws_token]<br />GET/POST http[s]://[domain_or_ip]/services/webcalls/[action-name]?login=[login]&amp;ws_token=[ws_token]&amp;project_id=[project_id]</pre></div>
</div>

<a name="Authentication"></a><a name="Topic45"></a><div class="CTopic TGroup LTextFile">
 <div class="CTitle">Authentication</div>
 <div class="CBody"><p>Public web calls actions do not require authentication.</p><p>Non-public calls require the &quot;login&quot; and &quot;ws_token&quot; arguments in the query string.</p><p>Non-static calls also require the &quot;project_id&quot; argument.</p><p>Besides, the &quot;app_url_name&quot; parameter can be specified to inform webAppOS and the web call about which web app is making the call. Although, webAppOS will try to infer the web app from other known information (e.g., from the web call location), providing the &quot;app_url_name&quot; explicitly can ensure that webAppOS knows about the web app even when an error occurs.</p><div class="CHeading">Example</div><pre>GET/POST https://example.org/services/webcalls/someAction?login=user1&amp;ws_token=<span class="SHNumber">123456</span>&amp;project_id=user1/myproject.owlgred</pre></div>
</div>

<a name="Sending_an_argument_via_the_GET_method"></a><a name="Topic46"></a><div class="CTopic TGroup LTextFile">
 <div class="CTitle">Sending an argument via the GET method</div>
 <div class="CBody"><p>Since the GET method does not have the data body, the web call argument must be encoded in the query string.</p><p>For jsoncall calling conventions, there are 2 options:</p><ul><li><p>to pass a string as a query argument named &quot;argument&quot;;</p></li><li><p>to encode the JSON argument as an URL data string and pass it as the query argument named &quot;json_argument&quot;;</p></li><li><p>or to encode each property of the JSON as a separate query argument in the name=value format, delimited by &amp;.</p></li></ul><div class="CHeading">Examples</div><pre>GET http[s]://[domain_or_ip]/services/webcalls/[action-name]?login=[login]&amp;ws_token=[ws_token]&amp;project_id=[project_id]&amp;argument=[some-<span class="SHKeyword">string</span>-to-be-passed-as-argument]<br />GET http[s]://[domain_or_ip]/services/webcalls/[action-name]?login=[login]&amp;ws_token=[ws_token]&amp;project_id=[project_id]&amp;json_argument=[stringified-JSON-argument]<br />GET http[s]://[domain_or_ip]/services/webcalls/[action-name]?login=[login]&amp;ws_token=[ws_token]&amp;project_id=[project_id]&amp;[property1]=[value1]&amp;[property2]=[value2]&amp;...</pre><p>For webmemcall calling conventions, specify the argument (object reference) via the argument query parameter:</p><div class="CHeading">Example</div><pre>GET http[s]://[domain_or_ip]/services/webcalls/[action-name]?login=[login]&amp;ws_token=[ws_token]&amp;project_id=[project_id]&amp;argument=[reference]</pre></div>
</div>

<a name="Sending_an_argument_via_the_POST_method"></a><a name="Topic47"></a><div class="CTopic TGroup LTextFile">
 <div class="CTitle">Sending an argument via the POST method</div>
 <div class="CBody"><p>Data must be sent as POST data encoded in UTF-8.</p><p>The following content types are supported:</p><pre>Content-Type: application/json<br />Content-Type: multipart/form-data<br />Content-Type: application/x-www-form-urlencoded</pre><p>In the latter two cases, the name=value pairs are assumed as properties { name: value } of the JSON object that will be passed to the web call.</p></div>
</div>

<a name="Web_call_result"></a><a name="Topic48"></a><div class="CTopic TGroup LTextFile">
 <div class="CTitle">Web call result</div>
 <div class="CBody"><p>Normally, the web call result is a JSON data (application/json).&nbsp; If an error occurred, a JSON object with the &quot;error&quot; property is returned.</p></div>
</div>

<a name="Pipe-like_usage_of_the_web_call_result"></a><a name="Topic49"></a><div class="CTopic TGroup LTextFile last">
 <div class="CTitle">Pipe-like usage of the web call result</div>
 <div class="CBody"><p>The web call result can be piped (injected) into HTML files. This is useful when JavaScript is not available, but the desired HTML file contains placeholders, which should be filled with some variable data returned by the web call.</p><p>The placeholder must be an HTML comment containing some JSON property name, e.g.:</p><pre>&lt;!--name--&gt;</pre><p>Then, if the web call returns a JSON { name: &quot;John&quot; }, the &quot;&lt;!--name--&gt;&quot; placeholder will be replaced by &quot;John&quot;.</p><p>HTML files can be specified by appending to the query string one of the following:</p><pre>|[on-success-HTML]<br />|[on-success-HTML],[on-error-HTML]<br />^[on-success-HTML]<br />^[on-success-HTML],[on-error-HTML]</pre><p>If only [on-success-HTML] is specified, all JSON properties are injected there. Otherwise, either the [on-success-HTML], or the [on-error-HTML] is used depending on whether the returned JSON contains the &quot;error&quot; property.</p><p>Both [on-success-HTML] and [on-error-HTML] are just names of .html files located in the web-root directory of the corresponding web app.</p><p>If &quot;|&quot; is used, the content of the HTML with injected JSON properties is returned as a response.</p><p>If &quot;^&quot; is used, a redirect to some HTML with injected JSON properties is returned. Use &quot;^&quot; to avoid multiple web calls, when the user refreshed the page containing the resulting HTML.&nbsp; This is in accordance with the Post-Redirect-Get principle (however, &quot;^&quot; works not only for the initial POST, but also GET requests).</p><div class="CHeading">Example</div><pre>?some=URL&amp;query=<span class="SHKeyword">string</span>|user_registered,user_not_registered</pre><p>It is recommended to add the &quot;app_url_name&quot; argument to the query string (but before the &quot;|&quot; or &quot;^&quot; symbols), so that webAppOS could find the corresponding on-success/on-error HTML files even when an error occurs.</p><div class="CHeading">Example</div><pre>?some=URL&amp;query=<span class="SHKeyword">string</span>&amp;app_url_name=myapp|user_registered,user_not_registered</pre></div>
</div>

</body></html>